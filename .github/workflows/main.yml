# This is a basic workflow to help you get started with Actions

name: Slack Cleaner

on:
  schedule:
    - cron:  '0 0 * * 0'

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  clean:
    runs-on: ubuntu-latest
    steps:
      - uses: lee-dohm/calculate-dates-and-times@v1.0.2
        id: before
        with:
          subtract: 7 days
          format: YYYYMMDD
      - run: echo "${{ steps.before.outputs.date }}"
      - uses: matken11235/slack-cleaner@v1
        name: 'Clear #notifications channel'
        with:
          token: ${{ secrets.SLACK_TOKEN }}
          message: true
          channel: notifications
          user: '*'
          before: "${{ steps.before.outputs.date }}"
          perform: false
